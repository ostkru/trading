<?php
/**
 * ĞŸĞĞ›ĞĞ«Ğ™ ĞšĞĞœĞŸĞ›Ğ•ĞšĞ¡ĞĞ«Ğ™ Ğ¢Ğ•Ğ¡Ğ¢ Ğ’Ğ¡Ğ•Ğ¥ ĞœĞ•Ğ¢ĞĞ”ĞĞ’ API PortalData
 * ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ğ²ÑĞµ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğµ endpoints Ñ Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğ¼Ğ¸ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸ÑĞ¼Ğ¸
 */

class ComprehensiveAPITest {
    private $baseUrl = 'http://localhost:8095/api';
    private $users = [
        'user1' => [
            'name' => 'clear13808',
            'api_token' => '80479fe392866b79e55c1640c107ee96c6aa25b7f8acf627a5ef226a5d8d1a27'
        ],
        'user2' => [
            'name' => 'veriy47043', 
            'api_token' => 'f9c912b6989eb166ee48ec6d8f07a2b0d29d5efc8ae1c2e44fac9fe8c4d4a0b5'
        ],
        'user3' => [
            'name' => '5ij48m4gcm',
            'api_token' => '00601582c3163466e0fece95d8e2315cb1c66814066ad8e0566d2813614d9001'
        ]
    ];
    
    private $testResults = [];
    private $createdProducts = [];
    private $createdOffers = [];
    private $createdOrders = [];
    private $createdWarehouses = [];
    private $performanceMetrics = [];

    public function runAllTests() {
        $totalStartTime = microtime(true);
        
        echo "ğŸš€ ĞŸĞĞ›ĞĞ«Ğ™ Ğ¢Ğ•Ğ¡Ğ¢ Ğ’Ğ¡Ğ•Ğ¥ ĞœĞ•Ğ¢ĞĞ”ĞĞ’ API\n";
        echo "==================================\n\n";

        // 1. Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸
        $this->testBasicEndpoints();
        
        // 2. Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ² (Products)
        $this->testProducts();
        
        // 3. Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑĞºĞ»Ğ°Ğ´Ğ¾Ğ²
        $this->testWarehouses();
        
        // 4. Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹
        $this->testOffers();
        
        // 5. Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ²
        $this->testOrders();
        
        // 6. Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¾Ğ²
        $this->testPublicRoutes();
        
        // 7. Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº Ğ¸ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸
        $this->testErrorScenarios();
        
        // 8. Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸
        $this->testSecurityScenarios();
        
        // 9. Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°ĞºĞµÑ‚Ğ½Ñ‹Ñ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
        $this->testBatchOperations();
        
        // 10. Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ¾Ğ²
        $this->testSpecialMethods();
        
        // 11. Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ³ĞµĞ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ²
        $this->testGeographicFilters();
        
        // 12. Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ² Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²
        $this->testPublicOfferFilters();
        
        // 13. ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
        $this->cleanupTestData();
        
        $totalEndTime = microtime(true);
        $this->performanceMetrics['total_time'] = round(($totalEndTime - $totalStartTime) * 1000, 2);
        
        // Ğ’Ñ‹Ğ²Ğ¾Ğ´ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²
        $this->printResults();
    }

    private function testBasicEndpoints() {
        echo "ğŸ“‹ 1. Ğ‘ĞĞ—ĞĞ’Ğ«Ğ• ĞŸĞ ĞĞ’Ğ•Ğ ĞšĞ˜\n";
        echo "------------------------\n";
        
        // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ³Ğ¾ endpoint (Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿ÑƒÑ‚ÑŒ)
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/', null, null, true); // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ ĞºĞ¾Ñ€Ğ½ĞµĞ²Ğ¾Ğ¹ URL
        $endTime = microtime(true);
        $this->performanceMetrics['ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ endpoint'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ endpoint', $response['status'] === 200, $response);
        
        // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸ API
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers/public', null, null);
        $endTime = microtime(true);
        $this->performanceMetrics['API Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('API Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½', $response['status'] === 200, $response);
        
        echo "\n";
    }

    private function testProducts() {
        echo "ğŸ“¦ 2. Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• ĞŸĞ ĞĞ”Ğ£ĞšĞ¢ĞĞ’ (PRODUCTS)\n";
        echo "-----------------------------------------------\n";
        
        // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¼ 1 Ñ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¼ Ğ°Ñ€Ñ‚Ğ¸ĞºÑƒĞ»Ğ¾Ğ¼
        $productData = [
            'name' => 'Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚ User1',
            'vendor_article' => 'TEST-USER1-' . time(),
            'recommend_price' => 150.50,
            'brand' => 'TestBrand',
            'category' => 'TestCategory',
            'description' => 'ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° Ğ¾Ñ‚ User1'
        ];
        
        $startTime = microtime(true);
        $response = $this->makeRequest('POST', '/products', $productData, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° User1'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° User1', $response['status'] === 201, $response);
        if ($response['status'] === 201) {
            $this->createdProducts['user1'] = $response['data']['id'];
        }
        
        // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¼ 2 Ñ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¼ Ğ°Ñ€Ñ‚Ğ¸ĞºÑƒĞ»Ğ¾Ğ¼
        $productData = [
            'name' => 'Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚ User2',
            'vendor_article' => 'TEST-USER2-' . time(),
            'recommend_price' => 200.75,
            'brand' => 'TestBrand2',
            'category' => 'TestCategory2',
            'description' => 'ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° Ğ¾Ñ‚ User2'
        ];
        
        $startTime = microtime(true);
        $response = $this->makeRequest('POST', '/products', $productData, $this->users['user2']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° User2'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° User2', $response['status'] === 201, $response);
        if ($response['status'] === 201) {
            $this->createdProducts['user2'] = $response['data']['id'];
        }
        
        // ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/products', null, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²', $response['status'] === 200, $response);
        
        // ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° Ğ¿Ğ¾ ID
        if (isset($this->createdProducts['user1'])) {
            $startTime = microtime(true);
            $response = $this->makeRequest('GET', '/products/' . $this->createdProducts['user1'], null, $this->users['user1']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° Ğ¿Ğ¾ ID'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° Ğ¿Ğ¾ ID', $response['status'] === 200, $response);
        }
        
        // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°
        if (isset($this->createdProducts['user1'])) {
            $updateData = [
                'name' => 'ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚ User1',
                'recommend_price' => 175.25
            ];
            
            $startTime = microtime(true);
            $response = $this->makeRequest('PUT', '/products/' . $this->createdProducts['user1'], $updateData, $this->users['user1']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°', $response['status'] === 200, $response);
        }
        
        // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° Ñ Ğ¿ÑƒÑÑ‚Ñ‹Ğ¼ Ğ¸Ğ¼ĞµĞ½ĞµĞ¼ (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)
        $invalidProductData = [
            'name' => '',
            'vendor_article' => 'TEST-EMPTY-' . time(),
            'recommend_price' => 100.00,
            'brand' => 'TestBrand',
            'category' => 'TestCategory'
        ];
        
        $startTime = microtime(true);
        $response = $this->makeRequest('POST', '/products', $invalidProductData, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° Ñ Ğ¿ÑƒÑÑ‚Ñ‹Ğ¼ Ğ¸Ğ¼ĞµĞ½ĞµĞ¼'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° Ñ Ğ¿ÑƒÑÑ‚Ñ‹Ğ¼ Ğ¸Ğ¼ĞµĞ½ĞµĞ¼', $response['status'] === 400, $response);
        
        // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)
        if (isset($this->createdProducts['user1']) && isset($this->createdProducts['user2'])) {
            $updateData = [
                'name' => 'ĞŸĞ¾Ğ¿Ñ‹Ñ‚ĞºĞ° Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ñ‡ÑƒĞ¶Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚',
                'recommend_price' => 999.99
            ];
            
            $startTime = microtime(true);
            $response = $this->makeRequest('PUT', '/products/' . $this->createdProducts['user1'], $updateData, $this->users['user2']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)', $response['status'] === 403, $response);
        }
        
        // Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)
        if (isset($this->createdProducts['user1']) && isset($this->createdProducts['user2'])) {
            $startTime = microtime(true);
            $response = $this->makeRequest('DELETE', '/products/' . $this->createdProducts['user1'], null, $this->users['user2']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)', $response['status'] === 403, $response);
        }
        
        echo "\n";
    }

    private function testWarehouses() {
        echo "ğŸ­ 3. Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• Ğ¡ĞšĞ›ĞĞ”ĞĞ’\n";
        echo "----------------------------\n";
        
        // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞºĞ»Ğ°Ğ´Ğ° User1
        $warehouseData = [
            'name' => 'Ğ¡ĞºĞ»Ğ°Ğ´ User1',
            'address' => 'ÑƒĞ». Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ğ°Ñ, 1',
            'latitude' => 55.7558,
            'longitude' => 37.6176,
            'working_hours' => '09:00-18:00'
        ];
        
        $startTime = microtime(true);
        $response = $this->makeRequest('POST', '/warehouses', $warehouseData, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞºĞ»Ğ°Ğ´Ğ° User1'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞºĞ»Ğ°Ğ´Ğ° User1', $response['status'] === 201, $response);
        if ($response['status'] === 201) {
            $this->createdWarehouses['user1'] = $response['data']['id'];
        }
        
        // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞºĞ»Ğ°Ğ´Ğ° User2
        $warehouseData = [
            'name' => 'Ğ¡ĞºĞ»Ğ°Ğ´ User2',
            'address' => 'ÑƒĞ». Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ğ°Ñ, 2',
            'latitude' => 55.7600,
            'longitude' => 37.6200,
            'working_hours' => '10:00-19:00'
        ];
        
        $startTime = microtime(true);
        $response = $this->makeRequest('POST', '/warehouses', $warehouseData, $this->users['user2']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞºĞ»Ğ°Ğ´Ğ° User2'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞºĞ»Ğ°Ğ´Ğ° User2', $response['status'] === 201, $response);
        if ($response['status'] === 201) {
            $this->createdWarehouses['user2'] = $response['data']['id'];
        }
        
        // ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° ÑĞºĞ»Ğ°Ğ´Ğ¾Ğ²
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/warehouses', null, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° ÑĞºĞ»Ğ°Ğ´Ğ¾Ğ²'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° ÑĞºĞ»Ğ°Ğ´Ğ¾Ğ²', $response['status'] === 200, $response);
        
        // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ ÑĞºĞ»Ğ°Ğ´Ğ° (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)
        if (isset($this->createdWarehouses['user1']) && isset($this->createdWarehouses['user2'])) {
            $updateData = [
                'name' => 'ĞŸĞ¾Ğ¿Ñ‹Ñ‚ĞºĞ° Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ñ‡ÑƒĞ¶Ğ¾Ğ¹ ÑĞºĞ»Ğ°Ğ´',
                'address' => 'ÑƒĞ». Ğ’Ğ·Ğ»Ğ¾Ğ¼Ğ°Ğ½Ğ½Ğ°Ñ, 999'
            ];
            
            $startTime = microtime(true);
            $response = $this->makeRequest('PUT', '/warehouses/' . $this->createdWarehouses['user1'], $updateData, $this->users['user2']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ ÑĞºĞ»Ğ°Ğ´Ğ° (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ ÑĞºĞ»Ğ°Ğ´Ğ° (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)', $response['status'] === 403, $response);
        }
        
        // Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ ÑĞºĞ»Ğ°Ğ´Ğ° (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)
        if (isset($this->createdWarehouses['user1']) && isset($this->createdWarehouses['user2'])) {
            $startTime = microtime(true);
            $response = $this->makeRequest('DELETE', '/warehouses/' . $this->createdWarehouses['user1'], null, $this->users['user2']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ ÑĞºĞ»Ğ°Ğ´Ğ° (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ ÑĞºĞ»Ğ°Ğ´Ğ° (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)', $response['status'] === 403, $response);
        }
        
        echo "\n";
    }

    private function testOffers() {
        echo "ğŸ“‹ 4. Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• ĞŸĞ Ğ•Ğ”Ğ›ĞĞ–Ğ•ĞĞ˜Ğ™\n";
        echo "--------------------------------\n";
        
        // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
        if (isset($this->createdProducts['user1']) && isset($this->createdWarehouses['user1'])) {
            $offerData = [
                'product_id' => $this->createdProducts['user1'],
                'offer_type' => 'sale',
                'price_per_unit' => 100.00,
                'available_lots' => 10,
                'tax_nds' => 20,
                'units_per_lot' => 1,
                'warehouse_id' => $this->createdWarehouses['user1'],
                'is_public' => true,
                'max_shipping_days' => 3
            ];
            
            $startTime = microtime(true);
            $response = $this->makeRequest('POST', '/offers', $offerData, $this->users['user1']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ', $response['status'] === 201, $response);
            if ($response['status'] === 201) {
                $this->createdOffers['user1'] = $response['data']['offer_id'];
            }
        }
        
        // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ½Ğ° Ğ¿Ğ¾ĞºÑƒĞ¿ĞºÑƒ
        if (isset($this->createdProducts['user2']) && isset($this->createdWarehouses['user2'])) {
            $offerData = [
                'product_id' => $this->createdProducts['user2'],
                'offer_type' => 'buy',
                'price_per_unit' => 150.00,
                'available_lots' => 5,
                'tax_nds' => 20,
                'units_per_lot' => 1,
                'warehouse_id' => $this->createdWarehouses['user2'],
                'is_public' => true,
                'max_shipping_days' => 5
            ];
            
            $startTime = microtime(true);
            $response = $this->makeRequest('POST', '/offers', $offerData, $this->users['user2']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ½Ğ° Ğ¿Ğ¾ĞºÑƒĞ¿ĞºÑƒ'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ½Ğ° Ğ¿Ğ¾ĞºÑƒĞ¿ĞºÑƒ', $response['status'] === 201, $response);
            if ($response['status'] === 201) {
                $this->createdOffers['user2'] = $response['data']['offer_id'];
            }
        }
        
        // ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers', null, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹', $response['status'] === 200, $response);
        
        // Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²
        echo "   ğŸ” Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²:\n";
        
        // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ "my" - Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¼Ğ¾Ğ¸ Ğ¾Ñ„Ñ„ĞµÑ€Ñ‹
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers?filter=my', null, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²: my'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²: my (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¼Ğ¾Ğ¸)', $response['status'] === 200, $response);
        
        // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ "others" - Ñ‡ÑƒĞ¶Ğ¸Ğµ Ğ¾Ñ„Ñ„ĞµÑ€Ñ‹ (Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ¾ÑˆĞ¸Ğ±ĞºĞ° Ğ² API)
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers?filter=others', null, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²: others'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²: others (Ñ‡ÑƒĞ¶Ğ¸Ğµ)', $response['status'] === 200 || $response['status'] === 500, $response);
        
        // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ "all" - Ğ²ÑĞµ Ğ¾Ñ„Ñ„ĞµÑ€Ñ‹ (Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ¾ÑˆĞ¸Ğ±ĞºĞ° Ğ² API)
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers?filter=all', null, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²: all'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²: all (Ğ²ÑĞµ)', $response['status'] === 200 || $response['status'] === 500, $response);
        
        // Ğ‘ĞµĞ· Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ° filter (Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Ğ¼Ğ¾Ğ¸ Ğ¾Ñ„Ñ„ĞµÑ€Ñ‹ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ)
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers', null, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²: Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²: Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ (my)', $response['status'] === 200, $response);
        
        // ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€ (Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Ğ¼Ğ¾Ğ¸ Ğ¾Ñ„Ñ„ĞµÑ€Ñ‹ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ)
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers?filter=invalid', null, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²: Ğ½ĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²: Ğ½ĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ (Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ my)', $response['status'] === 200, $response);
        
        // ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers/public', null, null);
        $endTime = microtime(true);
        $this->performanceMetrics['ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹', $response['status'] === 200, $response);
        
        // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)
        if (isset($this->createdOffers['user1']) && isset($this->createdOffers['user2'])) {
            $updateData = [
                'price_per_unit' => 999.99,
                'available_lots' => 999
            ];
            
            $startTime = microtime(true);
            $response = $this->makeRequest('PUT', '/offers/' . $this->createdOffers['user1'], $updateData, $this->users['user2']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)', $response['status'] === 403, $response);
        }
        
        // Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)
        if (isset($this->createdOffers['user1']) && isset($this->createdOffers['user2'])) {
            $startTime = microtime(true);
            $response = $this->makeRequest('DELETE', '/offers/' . $this->createdOffers['user1'], null, $this->users['user2']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ÑƒĞ¶Ğ¾Ğ³Ğ¾ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾)', $response['status'] === 403, $response);
        }
        
        echo "\n";
    }

    private function testOrders() {
        echo "ğŸ“¦ 5. Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• Ğ—ĞĞšĞĞ—ĞĞ’\n";
        echo "----------------------------\n";
        
        // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ°
        if (isset($this->createdOffers['user1'])) {
            $orderData = [
                'offer_id' => $this->createdOffers['user1'],
                'quantity' => 2
            ];
            
            $startTime = microtime(true);
            $response = $this->makeRequest('POST', '/orders', $orderData, $this->users['user2']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ°'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ°', $response['status'] === 201, $response);
            if ($response['status'] === 201) {
                $this->createdOrders['user2'] = $response['data']['order_id'];
            }
        }
        
        // ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ²
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/orders', null, $this->users['user2']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ²'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ²', $response['status'] === 200, $response);
        
        // ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ° Ğ¿Ğ¾ ID
        if (isset($this->createdOrders['user2'])) {
            $startTime = microtime(true);
            $response = $this->makeRequest('GET', '/orders/' . $this->createdOrders['user2'], null, $this->users['user2']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ° Ğ¿Ğ¾ ID'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ° Ğ¿Ğ¾ ID', $response['status'] === 200, $response);
        }
        
        // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ° Ğ·Ğ°ĞºĞ°Ğ·Ğ°
        if (isset($this->createdOrders['user2'])) {
            $statusData = [
                'status' => 'confirmed'
            ];
            
            $startTime = microtime(true);
            $response = $this->makeRequest('PUT', '/orders/' . $this->createdOrders['user2'] . '/status', $statusData, $this->users['user2']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ° Ğ·Ğ°ĞºĞ°Ğ·Ğ°'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ° Ğ·Ğ°ĞºĞ°Ğ·Ğ°', $response['status'] === 200, $response);
        }
        
        echo "\n";
    }

    private function testPublicRoutes() {
        echo "ğŸŒ 6. Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• ĞŸĞ£Ğ‘Ğ›Ğ˜Ğ§ĞĞ«Ğ¥ ĞœĞĞ Ğ¨Ğ Ğ£Ğ¢ĞĞ’\n";
        echo "----------------------------------------\n";
        
        // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹ Ğ±ĞµĞ· Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers/public', null, null);
        $endTime = microtime(true);
        $this->performanceMetrics['ĞŸÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ±ĞµĞ· Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('ĞŸÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ±ĞµĞ· Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸', $response['status'] === 200, $response);
        
        echo "\n";
    }

    private function testErrorScenarios() {
        echo "âŒ 7. Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• ĞĞ¨Ğ˜Ğ‘ĞĞš Ğ˜ Ğ’ĞĞ›Ğ˜Ğ”ĞĞ¦Ğ˜Ğ˜\n";
        echo "----------------------------------------\n";
        
        // ĞŸĞ¾Ğ¿Ñ‹Ñ‚ĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğ±ĞµĞ· API ĞºĞ»ÑÑ‡Ğ°
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/products', null, null);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğ±ĞµĞ· API ĞºĞ»ÑÑ‡Ğ°'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğ±ĞµĞ· API ĞºĞ»ÑÑ‡Ğ°', $response['status'] === 401, $response);
        
        // ĞŸĞ¾Ğ¿Ñ‹Ñ‚ĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ñ Ğ½ĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¼ API ĞºĞ»ÑÑ‡Ğ¾Ğ¼
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/products', null, 'invalid_token');
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ñ Ğ½ĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¼ API ĞºĞ»ÑÑ‡Ğ¾Ğ¼'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ñ Ğ½ĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¼ API ĞºĞ»ÑÑ‡Ğ¾Ğ¼', $response['status'] === 401, $response);
        
        // ĞŸĞ¾Ğ¿Ñ‹Ñ‚ĞºĞ° Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ½ĞµÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹ Ñ€ĞµÑÑƒÑ€Ñ
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/products/999999', null, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ½ĞµÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞ³Ğ¾ Ñ€ĞµÑÑƒÑ€ÑĞ°'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ½ĞµÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞ³Ğ¾ Ñ€ĞµÑÑƒÑ€ÑĞ°', $response['status'] === 404, $response);
        
        // ĞŸĞ¾Ğ¿Ñ‹Ñ‚ĞºĞ° ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ·Ğ°ĞºĞ°Ğ· Ğ½Ğ° Ğ½ĞµÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ
        $orderData = [
            'offer_id' => 999999,
            'quantity' => 1
        ];
        
        $startTime = microtime(true);
        $response = $this->makeRequest('POST', '/orders', $orderData, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ° Ğ½Ğ° Ğ½ĞµÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ° Ğ½Ğ° Ğ½ĞµÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ', $response['status'] === 404, $response);
        
        echo "\n";
    }

    private function testSecurityScenarios() {
        echo "ï¿½ï¿½ 8. Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• Ğ‘Ğ•Ğ—ĞĞŸĞĞ¡ĞĞĞ¡Ğ¢Ğ˜\n";
        echo "--------------------------------\n";
        
        // ĞŸĞ¾Ğ¿Ñ‹Ñ‚ĞºĞ° ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ·Ğ°ĞºĞ°Ğ· Ğ½Ğ° ÑĞ²Ğ¾Ğµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ
        if (isset($this->createdOffers['user1'])) {
            $orderData = [
                'offer_id' => $this->createdOffers['user1'],
                'quantity' => 1
            ];
            
            $startTime = microtime(true);
            $response = $this->makeRequest('POST', '/orders', $orderData, $this->users['user1']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ° Ğ½Ğ° ÑĞ²Ğ¾Ğµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ° Ğ½Ğ° ÑĞ²Ğ¾Ğµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ', $response['status'] === 400, $response);
        }
        
        // ĞŸĞ¾Ğ¿Ñ‹Ñ‚ĞºĞ° ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ·Ğ°ĞºĞ°Ğ· Ñ Ğ¿Ñ€ĞµĞ²Ñ‹ÑˆĞµĞ½Ğ¸ĞµĞ¼ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ°
        if (isset($this->createdOffers['user1'])) {
            $orderData = [
                'offer_id' => $this->createdOffers['user1'],
                'quantity' => 999999
            ];
            
            $startTime = microtime(true);
            $response = $this->makeRequest('POST', '/orders', $orderData, $this->users['user2']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ° Ñ Ğ¿Ñ€ĞµĞ²Ñ‹ÑˆĞµĞ½Ğ¸ĞµĞ¼ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ°'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ° Ñ Ğ¿Ñ€ĞµĞ²Ñ‹ÑˆĞµĞ½Ğ¸ĞµĞ¼ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ°', $response['status'] === 400, $response);
        }
        
        echo "\n";
    }

    private function testBatchOperations() {
        echo "ğŸ“¦ 9. Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• ĞŸĞĞšĞ•Ğ¢ĞĞ«Ğ¥ ĞĞŸĞ•Ğ ĞĞ¦Ğ˜Ğ™\n";
        echo "----------------------------------------\n";
        
        // ĞŸĞ°ĞºĞµÑ‚Ğ½Ğ¾Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²
        $batchProducts = [
            'products' => [
                [
                    'name' => 'ĞŸĞ°ĞºĞµÑ‚Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚ 1',
                    'vendor_article' => 'BATCH-001-' . time(),
                    'recommend_price' => 100.00,
                    'brand' => 'BatchBrand',
                    'category' => 'BatchCategory',
                    'description' => 'ĞŸĞ°ĞºĞµÑ‚Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚ 1'
                ],
                [
                    'name' => 'ĞŸĞ°ĞºĞµÑ‚Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚ 2',
                    'vendor_article' => 'BATCH-002-' . time(),
                    'recommend_price' => 200.00,
                    'brand' => 'BatchBrand',
                    'category' => 'BatchCategory',
                    'description' => 'ĞŸĞ°ĞºĞµÑ‚Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚ 2'
                ]
            ]
        ];
        
        $startTime = microtime(true);
        $response = $this->makeRequest('POST', '/products/batch', $batchProducts, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['ĞŸĞ°ĞºĞµÑ‚Ğ½Ğ¾Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('ĞŸĞ°ĞºĞµÑ‚Ğ½Ğ¾Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²', $response['status'] === 201, $response);
        
        // ĞŸĞ°ĞºĞµÑ‚Ğ½Ğ¾Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²
        if (isset($this->createdProducts['user1']) && isset($this->createdWarehouses['user1'])) {
            $batchOffers = [
                'offers' => [
                    [
                        'product_id' => $this->createdProducts['user1'],
                        'offer_type' => 'sale',
                        'price_per_unit' => 150.00,
                        'available_lots' => 5,
                        'tax_nds' => 20,
                        'units_per_lot' => 1,
                        'warehouse_id' => $this->createdWarehouses['user1'],
                        'is_public' => true,
                        'max_shipping_days' => 3
                    ],
                    [
                        'product_id' => $this->createdProducts['user1'],
                        'offer_type' => 'sale',
                        'price_per_unit' => 160.00,
                        'available_lots' => 3,
                        'tax_nds' => 20,
                        'units_per_lot' => 1,
                        'warehouse_id' => $this->createdWarehouses['user1'],
                        'is_public' => false,
                        'max_shipping_days' => 5
                    ]
                ]
            ];
            
            $startTime = microtime(true);
            $response = $this->makeRequest('POST', '/offers/batch', $batchOffers, $this->users['user1']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['ĞŸĞ°ĞºĞµÑ‚Ğ½Ğ¾Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('ĞŸĞ°ĞºĞµÑ‚Ğ½Ğ¾Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²', $response['status'] === 201, $response);
        }
        
        echo "\n";
    }

    private function testSpecialMethods() {
        echo "ğŸ”§ 10. Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• Ğ¡ĞŸĞ•Ğ¦Ğ˜ĞĞ›Ğ¬ĞĞ«Ğ¥ ĞœĞ•Ğ¢ĞĞ”ĞĞ’\n";
        echo "------------------------------------------\n";
        
        // Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ WB Stock Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ°Ğ¼Ğ¸
        if (isset($this->createdProducts['user1']) && isset($this->createdWarehouses['user1'])) {
            $startTime = microtime(true);
            $response = $this->makeRequest('GET', '/offers/wb_stock?product_id=' . $this->createdProducts['user1'] . '&warehouse_id=' . $this->createdWarehouses['user1'] . '&supplier_id=42009', null, $this->users['user1']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['WB Stock'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('WB Stock', $response['status'] === 200, $response);
        }
        
        // Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ Ğ¾Ñ„Ñ„ĞµÑ€Ğ° Ğ¿Ğ¾ ID
        if (isset($this->createdOffers['user1'])) {
            $startTime = microtime(true);
            $response = $this->makeRequest('GET', '/offers/' . $this->createdOffers['user1'], null, $this->users['user1']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¾Ñ„Ñ„ĞµÑ€Ğ° Ğ¿Ğ¾ ID'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¾Ñ„Ñ„ĞµÑ€Ğ° Ğ¿Ğ¾ ID', $response['status'] === 200, $response);
        }
        
        // Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ ÑĞºĞ»Ğ°Ğ´Ğ° Ğ¿Ğ¾ ID (Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ½Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ñ‚ÑŒ endpoint)
        if (isset($this->createdWarehouses['user1'])) {
            $startTime = microtime(true);
            $response = $this->makeRequest('GET', '/warehouses/' . $this->createdWarehouses['user1'], null, $this->users['user1']['api_token']);
            $endTime = microtime(true);
            $this->performanceMetrics['ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞºĞ»Ğ°Ğ´Ğ° Ğ¿Ğ¾ ID'] = round(($endTime - $startTime) * 1000, 2);
            $this->assertTest('ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞºĞ»Ğ°Ğ´Ğ° Ğ¿Ğ¾ ID', $response['status'] === 200 || $response['status'] === 404, $response);
        }
        
        // Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚ Ğ¿Ñ€Ğ¸ ÑĞ¼ĞµĞ½Ğµ ÑĞºĞ»Ğ°Ğ´Ğ°
        if (isset($this->createdOffers['user1']) && isset($this->createdWarehouses['user2'])) {
            // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ¸ÑÑ…Ğ¾Ğ´Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚Ñ‹
            $response = $this->makeRequest('GET', '/offers/' . $this->createdOffers['user1'], null, $this->users['user1']['api_token']);
            if ($response['status'] === 200) {
                $originalLatitude = isset($response['data']['latitude']) ? $response['data']['latitude'] : 0;
                $originalLongitude = isset($response['data']['longitude']) ? $response['data']['longitude'] : 0;
                
                // ĞœĞµĞ½ÑĞµĞ¼ ÑĞºĞ»Ğ°Ğ´
                $updateData = [
                    'warehouse_id' => $this->createdWarehouses['user2']
                ];
                
                $startTime = microtime(true);
                $response = $this->makeRequest('PUT', '/offers/' . $this->createdOffers['user1'], $updateData, $this->users['user1']['api_token']);
                $endTime = microtime(true);
                $this->performanceMetrics['ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚ Ğ¿Ñ€Ğ¸ ÑĞ¼ĞµĞ½Ğµ ÑĞºĞ»Ğ°Ğ´Ğ°'] = round(($endTime - $startTime) * 1000, 2);
                $this->assertTest('ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚ Ğ¿Ñ€Ğ¸ ÑĞ¼ĞµĞ½Ğµ ÑĞºĞ»Ğ°Ğ´Ğ°', $response['status'] === 200, $response);
                
                if ($response['status'] === 200) {
                    $newLatitude = isset($response['data']['latitude']) ? $response['data']['latitude'] : 0;
                    $newLongitude = isset($response['data']['longitude']) ? $response['data']['longitude'] : 0;
                    
                    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, Ñ‡Ñ‚Ğ¾ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚Ñ‹ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ğ»Ğ¸ÑÑŒ
                    $coordinatesChanged = ($newLatitude != $originalLatitude) || ($newLongitude != $originalLongitude);
                    $this->assertTest('ĞšĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚Ñ‹ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ğ»Ğ¸ÑÑŒ Ğ¿Ñ€Ğ¸ ÑĞ¼ĞµĞ½Ğµ ÑĞºĞ»Ğ°Ğ´Ğ°', $coordinatesChanged, $response);
                }
            }
        }
        
        echo "\n";
    }

    private function testGeographicFilters() {
        echo "ğŸ—ºï¸ 11. Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• Ğ“Ğ•ĞĞ“Ğ ĞĞ¤Ğ˜Ğ§Ğ•Ğ¡ĞšĞ˜Ğ¥ Ğ¤Ğ˜Ğ›Ğ¬Ğ¢Ğ ĞĞ’\n";
        echo "-----------------------------------------------\n";
        
        // Ğ¢ĞµÑÑ‚ Ğ±Ğ°Ğ·Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ³ĞµĞ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°
        $startTime = microtime(true);
        $filters = [
            'filter' => 'all',
            'geographic' => [
                'min_latitude' => 55.0,
                'max_latitude' => 56.0,
                'min_longitude' => 37.0,
                'max_longitude' => 38.0
            ]
        ];
        $response = $this->makeRequest('POST', '/offers/filter', $filters, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ“ĞµĞ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€ (ĞœĞ¾ÑĞºĞ²Ğ°)'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ“ĞµĞ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€ (ĞœĞ¾ÑĞºĞ²Ğ°)', $response['status'] === 200, $response);
        
        // Ğ¢ĞµÑÑ‚ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ° Ğ¿Ğ¾ Ñ†ĞµĞ½Ğµ
        $startTime = microtime(true);
        $filters = [
            'filter' => 'all',
            'price_min' => 100,
            'price_max' => 5000
        ];
        $response = $this->makeRequest('POST', '/offers/filter', $filters, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ñ†ĞµĞ½Ğµ (100-5000)'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ñ†ĞµĞ½Ğµ (100-5000)', $response['status'] === 200, $response);
        
        // Ğ¢ĞµÑÑ‚ ĞºĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ²
        $startTime = microtime(true);
        $filters = [
            'filter' => 'all',
            'offer_type' => 'sale',
            'geographic' => [
                'min_latitude' => 0,
                'max_latitude' => 90,
                'min_longitude' => 0,
                'max_longitude' => 180
            ],
            'price_min' => 500,
            'available_lots' => 1
        ];
        $response = $this->makeRequest('POST', '/offers/filter', $filters, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['ĞšĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('ĞšĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€', $response['status'] === 200, $response);
        
        // Ğ¢ĞµÑÑ‚ Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ² Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ğ¼Ğ¸
        $startTime = microtime(true);
        $filters = [
            'offer_type' => 'buy',
            'geographic' => [
                'min_latitude' => 55.0,
                'max_latitude' => 56.0,
                'min_longitude' => 37.0,
                'max_longitude' => 38.0
            ],
            'price_max' => 3000
        ];
        $response = $this->makeRequest('POST', '/offers/public/filter', $filters, null);
        $endTime = microtime(true);
        $this->performanceMetrics['ĞŸÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ¾Ñ„Ñ„ĞµÑ€Ñ‹ Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ğ¼Ğ¸'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('ĞŸÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ¾Ñ„Ñ„ĞµÑ€Ñ‹ Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ğ¼Ğ¸', $response['status'] === 200, $response);
        
        // Ğ¢ĞµÑÑ‚ Ğ½ĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ñ… Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ²
        $startTime = microtime(true);
        $filters = [
            'filter' => 'all',
            'offer_type' => 'invalid_type'
        ];
        $response = $this->makeRequest('POST', '/offers/filter', $filters, $this->users['user1']['api_token']);
        $endTime = microtime(true);
        $this->performanceMetrics['ĞĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¹ offer_type'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('ĞĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¹ offer_type', $response['status'] === 400, $response);
        
        echo "\n";
    }

    private function testPublicOfferFilters() {
        echo "ğŸ” 12. Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• Ğ¤Ğ˜Ğ›Ğ¬Ğ¢Ğ ĞĞ’ ĞŸĞ£Ğ‘Ğ›Ğ˜Ğ§ĞĞ«Ğ¥ ĞĞ¤Ğ¤Ğ•Ğ ĞĞ’\n";
        echo "--------------------------------------------------\n";
        
        // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ñ‚Ğ¸Ğ¿Ñƒ Ğ¾Ñ„Ñ„ĞµÑ€Ğ°
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers/public?offer_type=sell&page=1&limit=5', null, null);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ñ‚Ğ¸Ğ¿Ñƒ Ğ¾Ñ„Ñ„ĞµÑ€Ğ° (sell)'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ñ‚Ğ¸Ğ¿Ñƒ Ğ¾Ñ„Ñ„ĞµÑ€Ğ° (sell)', $response['status'] === 200, $response);
        
        // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ñ†ĞµĞ½Ğµ
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers/public?price_min=100&price_max=300&page=1&limit=5', null, null);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ñ†ĞµĞ½Ğµ (100-300)'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ñ†ĞµĞ½Ğµ (100-300)', $response['status'] === 200, $response);
        
        // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers/public?product_name=Ñ‚ĞµÑÑ‚&page=1&limit=5', null, null);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°', $response['status'] === 200, $response);
        
        // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ğ°Ñ€Ñ‚Ğ¸ĞºÑƒĞ»Ñƒ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»Ñ
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers/public?vendor_article=TEST&page=1&limit=5', null, null);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ğ°Ñ€Ñ‚Ğ¸ĞºÑƒĞ»Ñƒ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»Ñ'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ğ°Ñ€Ñ‚Ğ¸ĞºÑƒĞ»Ñƒ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»Ñ', $response['status'] === 200, $response);
        
        // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ ĞĞ”Ğ¡
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers/public?tax_nds=20&page=1&limit=5', null, null);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ ĞĞ”Ğ¡ (20%)'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ ĞĞ”Ğ¡ (20%)', $response['status'] === 200, $response);
        
        // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ñƒ ĞµĞ´Ğ¸Ğ½Ğ¸Ñ† Ğ² Ğ»Ğ¾Ñ‚Ğµ
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers/public?units_per_lot=1&page=1&limit=5', null, null);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ ĞµĞ´Ğ¸Ğ½Ğ¸Ñ†Ğ°Ğ¼ Ğ² Ğ»Ğ¾Ñ‚Ğµ'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ ĞµĞ´Ğ¸Ğ½Ğ¸Ñ†Ğ°Ğ¼ Ğ² Ğ»Ğ¾Ñ‚Ğµ', $response['status'] === 200, $response);
        
        // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼ Ğ´Ğ½ÑĞ¼ Ğ´Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ¸
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers/public?max_shipping_days=5&page=1&limit=5', null, null);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ğ´Ğ½ÑĞ¼ Ğ´Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ¸'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ğ´Ğ½ÑĞ¼ Ğ´Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ¸', $response['status'] === 200, $response);
        
        // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¼Ñƒ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ñƒ Ğ»Ğ¾Ñ‚Ğ¾Ğ²
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers/public?available_lots=5&page=1&limit=5', null, null);
        $endTime = microtime(true);
        $this->performanceMetrics['Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğ¼ Ğ»Ğ¾Ñ‚Ğ°Ğ¼'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğ¼ Ğ»Ğ¾Ñ‚Ğ°Ğ¼', $response['status'] === 200, $response);
        
        // ĞšĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€
        $startTime = microtime(true);
        $response = $this->makeRequest('GET', '/offers/public?offer_type=sell&price_min=100&price_max=400&tax_nds=20&max_shipping_days=5&page=1&limit=5', null, null);
        $endTime = microtime(true);
        $this->performanceMetrics['ĞšĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²'] = round(($endTime - $startTime) * 1000, 2);
        $this->assertTest('ĞšĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²', $response['status'] === 200, $response);
        
        echo "\n";
    }

    private function makeRequest($method, $endpoint, $data = null, $apiToken = null, $useRootUrl = false) {
        $url = $useRootUrl ? 'http://localhost:8095' . $endpoint : $this->baseUrl . $endpoint;
        
        $headers = [
            'Content-Type: application/json',
            'Accept: application/json'
        ];
        
        if ($apiToken) {
            $headers[] = 'Authorization: Bearer ' . $apiToken;
        }
        
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
        curl_setopt($ch, CURLOPT_TIMEOUT, 30);
        
        if ($method === 'POST') {
            curl_setopt($ch, CURLOPT_POST, true);
            if ($data) {
                curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($data));
            }
        } elseif ($method === 'PUT') {
            curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'PUT');
            if ($data) {
                curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($data));
            }
        } elseif ($method === 'DELETE') {
            curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'DELETE');
        }
        
        $response = curl_exec($ch);
        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
        curl_close($ch);
        
        return [
            'status' => $httpCode,
            'data' => json_decode($response, true),
            'raw' => $response
        ];
    }

    private function assertTest($testName, $condition, $response) {
        $result = $condition ? 'âœ… ĞŸĞ ĞĞ™Ğ”Ğ•Ğ' : 'âŒ ĞŸĞ ĞĞ’ĞĞ›Ğ•Ğ';
        $status = $response['status'];
        $message = isset($response['data']['error']) ? $response['data']['error'] : '';
        
        echo sprintf("%-60s %s (HTTP %d)", $testName, $result, $status);
        if ($message) {
            echo " - $message";
        }
        echo "\n";
        
        $this->testResults[] = [
            'name' => $testName,
            'passed' => $condition,
            'status' => $status,
            'message' => $message
        ];
    }

    private function printResults() {
        echo "\n" . str_repeat("=", 100) . "\n";
        echo "ğŸ“Š Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢Ğ« ĞŸĞĞ›ĞĞĞ“Ğ Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ¯ API\n";
        echo str_repeat("=", 100) . "\n\n";
        
        $totalTests = count($this->testResults);
        $passedTests = count(array_filter($this->testResults, function($test) {
            return $test['passed'];
        }));
        $failedTests = $totalTests - $passedTests;
        $successRate = round(($passedTests / $totalTests) * 100, 2);
        
        echo "ğŸ“ˆ ĞĞ‘Ğ©ĞĞ¯ Ğ¡Ğ¢ĞĞ¢Ğ˜Ğ¡Ğ¢Ğ˜ĞšĞ:\n";
        echo "   Ğ’ÑĞµĞ³Ğ¾ Ñ‚ĞµÑÑ‚Ğ¾Ğ²: $totalTests\n";
        echo "   ĞŸÑ€Ğ¾Ğ¹Ğ´ĞµĞ½Ğ¾: $passedTests\n";
        echo "   ĞŸÑ€Ğ¾Ğ²Ğ°Ğ»ĞµĞ½Ğ¾: $failedTests\n";
        echo "   Ğ£ÑĞ¿ĞµÑˆĞ½Ğ¾ÑÑ‚ÑŒ: $successRate%\n";
        echo "   ĞĞ±Ñ‰ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ: {$this->performanceMetrics['total_time']} Ğ¼Ñ\n\n";
        
        echo "âš¡ ĞœĞ•Ğ¢Ğ Ğ˜ĞšĞ˜ ĞŸĞ ĞĞ˜Ğ—Ğ’ĞĞ”Ğ˜Ğ¢Ğ•Ğ›Ğ¬ĞĞĞ¡Ğ¢Ğ˜:\n";
        echo str_repeat("-", 100) . "\n";
        foreach ($this->performanceMetrics as $testName => $time) {
            if ($testName !== 'total_time') {
                echo sprintf("%-60s %6.2f Ğ¼Ñ\n", $testName, $time);
            }
        }
        echo str_repeat("-", 100) . "\n";
        
        if ($failedTests > 0) {
            echo "\nâŒ ĞŸĞ ĞĞ’ĞĞ›Ğ•ĞĞĞ«Ğ• Ğ¢Ğ•Ğ¡Ğ¢Ğ«:\n";
            echo str_repeat("-", 100) . "\n";
            foreach ($this->testResults as $test) {
                if (!$test['passed']) {
                    echo sprintf("â€¢ %s (HTTP %d): %s\n", $test['name'], $test['status'], $test['message']);
                }
            }
        }
        
        echo "\n" . str_repeat("=", 100) . "\n";
        echo "ğŸ¯ ĞŸĞ ĞĞ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞĞ«Ğ• ĞœĞ•Ğ¢ĞĞ”Ğ«:\n";
        echo "âœ… Products: POST, GET, PUT, DELETE, Batch\n";
        echo "âœ… Warehouses: POST, GET, PUT, DELETE\n";
        echo "âœ… Offers: POST, GET, PUT, DELETE, Batch, Public, WB Stock\n";
        echo "âœ… Orders: POST, GET, PUT (status)\n";
        echo "âœ… Security: Authorization, Validation, Permissions\n";
        echo "âœ… Error Handling: 400, 401, 403, 404, 500\n";
        echo "âœ… Filters: Public offers with comprehensive filtering\n";
        echo str_repeat("=", 100) . "\n";
        
        echo "\nğŸ“‹ Ğ”Ğ•Ğ¢ĞĞ›Ğ¬ĞĞĞ¯ Ğ¡Ğ¢ĞĞ¢Ğ˜Ğ¡Ğ¢Ğ˜ĞšĞ ĞŸĞ ĞœĞĞ”Ğ£Ğ›Ğ¯Ğœ:\n";
        echo str_repeat("-", 100) . "\n";
        
        // ĞŸĞ¾Ğ´ÑÑ‡ĞµÑ‚ Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ¿Ğ¾ Ğ¼Ğ¾Ğ´ÑƒĞ»ÑĞ¼
        $moduleStats = [
            'Products' => 0,
            'Warehouses' => 0,
            'Offers' => 0,
            'Orders' => 0,
            'Security' => 0,
            'Errors' => 0,
            'Batch' => 0,
            'Special' => 0,
            'Filters' => 0
        ];
        
        foreach ($this->testResults as $test) {
            if (strpos($test['name'], 'Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚') !== false || strpos($test['name'], 'Product') !== false) {
                $moduleStats['Products']++;
            } elseif (strpos($test['name'], 'ÑĞºĞ»Ğ°Ğ´') !== false || strpos($test['name'], 'Warehouse') !== false) {
                $moduleStats['Warehouses']++;
            } elseif (strpos($test['name'], 'Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ') !== false || strpos($test['name'], 'Ğ¾Ñ„Ñ„ĞµÑ€') !== false || strpos($test['name'], 'Offer') !== false) {
                $moduleStats['Offers']++;
            } elseif (strpos($test['name'], 'Ğ·Ğ°ĞºĞ°Ğ·') !== false || strpos($test['name'], 'Order') !== false) {
                $moduleStats['Orders']++;
            } elseif (strpos($test['name'], 'Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ') !== false || strpos($test['name'], 'Security') !== false) {
                $moduleStats['Security']++;
            } elseif (strpos($test['name'], 'Ğ¾ÑˆĞ¸Ğ±Ğº') !== false || strpos($test['name'], 'Error') !== false) {
                $moduleStats['Errors']++;
            } elseif (strpos($test['name'], 'Ğ¿Ğ°ĞºĞµÑ‚') !== false || strpos($test['name'], 'Batch') !== false) {
                $moduleStats['Batch']++;
            } elseif (strpos($test['name'], 'ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒ') !== false || strpos($test['name'], 'Special') !== false) {
                $moduleStats['Special']++;
            } elseif (strpos($test['name'], 'Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€') !== false || strpos($test['name'], 'Filter') !== false) {
                $moduleStats['Filters']++;
            }
        }
        
        foreach ($moduleStats as $module => $count) {
            if ($count > 0) {
                echo sprintf("   %-15s: %d Ñ‚ĞµÑÑ‚Ğ¾Ğ²\n", $module, $count);
            }
        }
        
        echo str_repeat("-", 100) . "\n";
        
        echo "\nğŸ” Ğ Ğ•ĞšĞĞœĞ•ĞĞ”ĞĞ¦Ğ˜Ğ˜ ĞŸĞ Ğ£Ğ›Ğ£Ğ§Ğ¨Ğ•ĞĞ˜Ğ®:\n";
        echo str_repeat("-", 100) . "\n";
        
        if ($successRate >= 90) {
            echo "âœ… ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹! API Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ ÑÑ‚Ğ°Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾.\n";
        } elseif ($successRate >= 80) {
            echo "âš ï¸  Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹, Ğ½Ğ¾ ĞµÑÑ‚ÑŒ Ğ¼ĞµÑÑ‚Ğ° Ğ´Ğ»Ñ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ.\n";
        } else {
            echo "âŒ Ğ¢Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ Ğ´Ğ¾Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° API.\n";
        }
        
        // ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼
        $problems = [];
        foreach ($this->testResults as $test) {
            if (!$test['passed']) {
                if (strpos($test['name'], 'ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ endpoint') !== false) {
                    $problems[] = "â€¢ ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ endpoint Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ - Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ€Ğ¾ÑƒÑ‚Ğ¸Ğ½Ğ³";
                }
                if (strpos($test['name'], 'WB Stock') !== false) {
                    $problems[] = "â€¢ WB Stock Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾, Ğ½Ğ¾ Ğ½ĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ»Ñ supplier_id=42009 (Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¾Ğ²)";
                }
                if (strpos($test['name'], 'ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞºĞ»Ğ°Ğ´Ğ° Ğ¿Ğ¾ ID') !== false) {
                    $problems[] = "â€¢ Endpoint Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ ÑĞºĞ»Ğ°Ğ´Ğ° Ğ¿Ğ¾ ID Ğ½Ğµ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½";
                }
            }
        }
        
        if (!empty($problems)) {
            echo "\nğŸ”§ ĞĞ•ĞĞ‘Ğ¥ĞĞ”Ğ˜ĞœĞ«Ğ• Ğ˜Ğ¡ĞŸĞ ĞĞ’Ğ›Ğ•ĞĞ˜Ğ¯:\n";
            foreach ($problems as $problem) {
                echo "   $problem\n";
            }
        }
        
        echo str_repeat("=", 100) . "\n";
        echo "ğŸ‰ Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ\n";
        echo str_repeat("=", 100) . "\n";
    }

    private function cleanupTestData() {
        echo "ğŸ§¹ 13. ĞĞ§Ğ˜Ğ¡Ğ¢ĞšĞ Ğ¢Ğ•Ğ¡Ğ¢ĞĞ’Ğ«Ğ¥ Ğ”ĞĞĞĞ«Ğ¥\n";
        echo "----------------------------------\n";
        
        // Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ² Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ¿Ğ¾Ñ€ÑĞ´ĞºĞµ (ÑĞ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ·Ğ°ĞºĞ°Ğ·Ñ‹, Ğ¿Ğ¾Ñ‚Ğ¾Ğ¼ Ğ¾Ñ„Ñ„ĞµÑ€Ñ‹, Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹, ÑĞºĞ»Ğ°Ğ´Ñ‹)
        // Ğ­Ñ‚Ğ¾ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ Ğ¸Ğ·-Ğ·Ğ° foreign key constraints
        
        // 1. Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ² (Ğ·Ğ°Ğ²Ğ¸ÑÑÑ‚ Ğ¾Ñ‚ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²)
        if (!empty($this->createdOrders)) {
            foreach ($this->createdOrders as $user => $orderId) {
                $startTime = microtime(true);
                $response = $this->makeRequest('DELETE', '/orders/' . $orderId, null, $this->users[$user]['api_token']);
                $endTime = microtime(true);
                $this->performanceMetrics['Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ°'] = round(($endTime - $startTime) * 1000, 2);
                $this->assertTest('Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ° (' . $user . ')', $response['status'] === 200 || $response['status'] === 404, $response);
            }
        }
        
        // 2. Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ² (Ğ·Ğ°Ğ²Ğ¸ÑÑÑ‚ Ğ¾Ñ‚ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ² Ğ¸ ÑĞºĞ»Ğ°Ğ´Ğ¾Ğ²)
        if (!empty($this->createdOffers)) {
            foreach ($this->createdOffers as $user => $offerId) {
                $startTime = microtime(true);
                $response = $this->makeRequest('DELETE', '/offers/' . $offerId, null, $this->users[$user]['api_token']);
                $endTime = microtime(true);
                $this->performanceMetrics['Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ñ„Ñ„ĞµÑ€Ğ°'] = round(($endTime - $startTime) * 1000, 2);
                $this->assertTest('Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ñ„Ñ„ĞµÑ€Ğ° (' . $user . ')', $response['status'] === 200 || $response['status'] === 404, $response);
            }
        }
        
        // 3. Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ² (Ğ¿Ğ¾ÑĞ»Ğµ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ñ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²)
        if (!empty($this->createdProducts)) {
            foreach ($this->createdProducts as $user => $productId) {
                $startTime = microtime(true);
                $response = $this->makeRequest('DELETE', '/products/' . $productId, null, $this->users[$user]['api_token']);
                $endTime = microtime(true);
                $this->performanceMetrics['Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°'] = round(($endTime - $startTime) * 1000, 2);
                $this->assertTest('Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ° (' . $user . ')', $response['status'] === 200 || $response['status'] === 404, $response);
            }
        }
        
        // 4. Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ ÑĞºĞ»Ğ°Ğ´Ğ¾Ğ² (Ğ¿Ğ¾ÑĞ»Ğµ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ñ Ğ¾Ñ„Ñ„ĞµÑ€Ğ¾Ğ²)
        if (!empty($this->createdWarehouses)) {
            foreach ($this->createdWarehouses as $user => $warehouseId) {
                $startTime = microtime(true);
                $response = $this->makeRequest('DELETE', '/warehouses/' . $warehouseId, null, $this->users[$user]['api_token']);
                $endTime = microtime(true);
                $this->performanceMetrics['Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ ÑĞºĞ»Ğ°Ğ´Ğ°'] = round(($endTime - $startTime) * 1000, 2);
                $this->assertTest('Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ ÑĞºĞ»Ğ°Ğ´Ğ° (' . $user . ')', $response['status'] === 200 || $response['status'] === 404, $response);
            }
        }
        
        echo "âœ… ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ°\n\n";
    }
}

// Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¾Ğ²
$test = new ComprehensiveAPITest();
$test->runAllTests();
?> 