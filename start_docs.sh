#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API –Ω–∞ –ø–æ—Ä—Ç—É 8090

echo "üöÄ –ó–∞–ø—É—Å–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API –Ω–∞ –ø–æ—Ä—Ç—É 8090..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ—Ä—Ç —Å–≤–æ–±–æ–¥–µ–Ω
if netstat -tlnp | grep -q ":8090"; then
    echo "‚ùå –ü–æ—Ä—Ç 8090 —É–∂–µ –∑–∞–Ω—è—Ç!"
    netstat -tlnp | grep ":8090"
    exit 1
fi

# –ó–∞–ø—É—Å–∫–∞–µ–º Python HTTP —Å–µ—Ä–≤–µ—Ä –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è HTML –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
echo "üìñ –ó–∞–ø—É—Å–∫ HTTP —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏..."
python3 -m http.server 8090 --bind 0.0.0.0 --directory /var/www/gogo/go-mod &

# –ñ–¥–µ–º –∑–∞–ø—É—Å–∫–∞
sleep 3

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏–ª—Å—è
if netstat -tlnp | grep -q ":8090"; then
    echo "‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω–∞!"
    echo "üåê –î–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8090"
    echo "üìã –§–∞–π–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:"
    echo "   - http://localhost:8090/redoc-documentation.html (–ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)"
    echo "   - http://localhost:8090/docs.html (–∫—Ä–∞—Ç–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)"
    echo "   - http://localhost:8090/index.html (–≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞)"
else
    echo "‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏"
    exit 1
fi 